2024-10-03 15:32:36.481 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
REVOKE CONNECT ON DATABASE "medTime" FROM PUBLIC;
SELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity WHERE datname = 'medTime';
2024-10-03 15:32:36.636 +07:00 [INF] Executed DbCommand (102ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP DATABASE "medTime";
2024-10-03 15:32:37.141 +07:00 [INF] Executed DbCommand (375ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE DATABASE "medTime";
2024-10-03 15:32:38.171 +07:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Doctors" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Speciality" text NOT NULL,
    "FirstName" text NOT NULL,
    "LastName" text NOT NULL,
    "Age" integer NOT NULL,
    CONSTRAINT "PK_Doctors" PRIMARY KEY ("Id")
);
2024-10-03 15:32:38.180 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Patients" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "FirstName" text NOT NULL,
    "LastName" text NOT NULL,
    "Age" integer NOT NULL,
    CONSTRAINT "PK_Patients" PRIMARY KEY ("Id")
);
2024-10-03 15:32:38.194 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Schedules" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "DoctorId" integer NOT NULL,
    "DayOfWeek" integer NOT NULL,
    "StartTime" timestamp with time zone NOT NULL,
    "EndTime" timestamp with time zone NOT NULL,
    "AppointmentDuration" interval NOT NULL,
    "StartLunchTime" timestamp with time zone NOT NULL,
    "EndLunchTime" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_Schedules" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_Schedules_Doctors_DoctorId" FOREIGN KEY ("DoctorId") REFERENCES "Doctors" ("Id") ON DELETE CASCADE
);
2024-10-03 15:32:38.200 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "CellTimes" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Time" timestamp with time zone NOT NULL,
    "PatientId" integer NULL,
    "ScheduleId" integer NOT NULL,
    CONSTRAINT "PK_CellTimes" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_CellTimes_Patients_PatientId" FOREIGN KEY ("PatientId") REFERENCES "Patients" ("Id"),
    CONSTRAINT "FK_CellTimes_Schedules_ScheduleId" FOREIGN KEY ("ScheduleId") REFERENCES "Schedules" ("Id") ON DELETE CASCADE
);
2024-10-03 15:32:38.204 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_CellTimes_PatientId" ON "CellTimes" ("PatientId");
2024-10-03 15:32:38.208 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_CellTimes_ScheduleId" ON "CellTimes" ("ScheduleId");
2024-10-03 15:32:38.212 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Schedules_DoctorId" ON "Schedules" ("DoctorId");
2024-10-03 15:32:38.303 +07:00 [INF] User profile is available. Using 'C:\Users\krasyukMA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-10-03 15:32:38.358 +07:00 [INF] Now listening on: http://localhost:5080
2024-10-03 15:32:38.360 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-10-03 15:32:38.362 +07:00 [INF] Hosting environment: Development
2024-10-03 15:32:38.362 +07:00 [INF] Content root path: D:\RiderProject\MedTimeSlot.Api\MedTimeSlot.Api
2024-10-03 15:33:01.274 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5080/Doctor - -
2024-10-03 15:33:01.345 +07:00 [INF] Executing endpoint 'MedTimeSlot.Api.Controllers.DoctorController.GetAllDoctorsAsync (MedTimeSlot.Api)'
2024-10-03 15:33:01.367 +07:00 [INF] Route matched with {action = "GetAllDoctors", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[MedTimeSlot.Api.DTOs.DoctorResponse]] GetAllDoctorsAsync() on controller MedTimeSlot.Api.Controllers.DoctorController (MedTimeSlot.Api).
2024-10-03 15:33:01.466 +07:00 [INF] Executing action method MedTimeSlot.Api.Controllers.DoctorController.GetAllDoctorsAsync (MedTimeSlot.Api) - Validation state: "Valid"
2024-10-03 15:33:01.468 +07:00 [INF] Getting all doctors
2024-10-03 15:33:01.693 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT d."Id", d."Age", d."FirstName", d."LastName", d."Speciality"
FROM "Doctors" AS d
2024-10-03 15:33:01.725 +07:00 [INF] Executed action MedTimeSlot.Api.Controllers.DoctorController.GetAllDoctorsAsync (MedTimeSlot.Api) in 351.5609ms
2024-10-03 15:33:01.728 +07:00 [INF] Executed endpoint 'MedTimeSlot.Api.Controllers.DoctorController.GetAllDoctorsAsync (MedTimeSlot.Api)'
2024-10-03 15:33:01.878 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5080/Doctor - - - 500 - application/json;+charset=utf-8 607.1101ms
2024-10-03 15:50:23.687 +07:00 [INF] Application is shutting down...
2024-10-03 15:50:31.041 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
REVOKE CONNECT ON DATABASE "medTime" FROM PUBLIC;
SELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity WHERE datname = 'medTime';
2024-10-03 15:50:31.229 +07:00 [INF] Executed DbCommand (95ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP DATABASE "medTime";
2024-10-03 15:50:31.698 +07:00 [INF] Executed DbCommand (335ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE DATABASE "medTime";
2024-10-03 15:50:32.551 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Doctors" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Speciality" text NOT NULL,
    "FirstName" text NOT NULL,
    "LastName" text NOT NULL,
    "Age" integer NOT NULL,
    CONSTRAINT "PK_Doctors" PRIMARY KEY ("Id")
);
2024-10-03 15:50:32.559 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Patients" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "FirstName" text NOT NULL,
    "LastName" text NOT NULL,
    "Age" integer NOT NULL,
    CONSTRAINT "PK_Patients" PRIMARY KEY ("Id")
);
2024-10-03 15:50:32.566 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Schedules" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "DoctorId" integer NOT NULL,
    "DayOfWeek" integer NOT NULL,
    "StartTime" timestamp with time zone NOT NULL,
    "EndTime" timestamp with time zone NOT NULL,
    "AppointmentDuration" interval NOT NULL,
    "StartLunchTime" timestamp with time zone NOT NULL,
    "EndLunchTime" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_Schedules" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_Schedules_Doctors_DoctorId" FOREIGN KEY ("DoctorId") REFERENCES "Doctors" ("Id") ON DELETE CASCADE
);
2024-10-03 15:50:32.571 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "CellTimes" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Time" timestamp with time zone NOT NULL,
    "PatientId" integer NULL,
    "ScheduleId" integer NOT NULL,
    CONSTRAINT "PK_CellTimes" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_CellTimes_Patients_PatientId" FOREIGN KEY ("PatientId") REFERENCES "Patients" ("Id"),
    CONSTRAINT "FK_CellTimes_Schedules_ScheduleId" FOREIGN KEY ("ScheduleId") REFERENCES "Schedules" ("Id") ON DELETE CASCADE
);
2024-10-03 15:50:32.575 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_CellTimes_PatientId" ON "CellTimes" ("PatientId");
2024-10-03 15:50:32.578 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_CellTimes_ScheduleId" ON "CellTimes" ("ScheduleId");
2024-10-03 15:50:32.582 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Schedules_DoctorId" ON "Schedules" ("DoctorId");
2024-10-03 15:50:32.706 +07:00 [INF] User profile is available. Using 'C:\Users\krasyukMA\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-10-03 15:50:32.759 +07:00 [INF] Now listening on: http://localhost:5080
2024-10-03 15:50:32.762 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-10-03 15:50:32.763 +07:00 [INF] Hosting environment: Development
2024-10-03 15:50:32.764 +07:00 [INF] Content root path: D:\RiderProject\MedTimeSlot.Api\MedTimeSlot.Api
2024-10-03 15:50:35.240 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5080/swagger/index.html - -
2024-10-03 15:50:35.437 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5080/swagger/index.html - - - 200 - text/html;charset=utf-8 199.3926ms
2024-10-03 15:50:35.604 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5080/swagger/v1/swagger.json - -
2024-10-03 15:50:35.724 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5080/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 119.9713ms
2024-10-03 15:50:40.254 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5080/Register - -
2024-10-03 15:50:40.297 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Patient)
2024-10-03 15:50:40.307 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2024-10-03 15:50:40.308 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5080/Register - - - 401 0 - 54.5497ms
2024-10-03 15:51:10.275 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5080/Register - -
2024-10-03 15:51:10.281 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Patient)
2024-10-03 15:51:10.283 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2024-10-03 15:51:10.285 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5080/Register - - - 401 0 - 10.0577ms
2024-10-03 15:51:55.136 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5080/Register - -
2024-10-03 15:51:56.531 +07:00 [INF] Executing endpoint 'MedTimeSlot.Api.Controllers.RegisterController.Test (MedTimeSlot.Api)'
2024-10-03 15:51:56.549 +07:00 [INF] Route matched with {action = "Test", controller = "Register"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Test() on controller MedTimeSlot.Api.Controllers.RegisterController (MedTimeSlot.Api).
2024-10-03 15:51:56.557 +07:00 [INF] Executing action method MedTimeSlot.Api.Controllers.RegisterController.Test (MedTimeSlot.Api) - Validation state: "Valid"
2024-10-03 15:51:56.563 +07:00 [INF] Executed action method MedTimeSlot.Api.Controllers.RegisterController.Test (MedTimeSlot.Api), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 0.4204ms.
2024-10-03 15:51:56.576 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-10-03 15:51:56.597 +07:00 [INF] Executed action MedTimeSlot.Api.Controllers.RegisterController.Test (MedTimeSlot.Api) in 42.6547ms
2024-10-03 15:51:56.598 +07:00 [INF] Executed endpoint 'MedTimeSlot.Api.Controllers.RegisterController.Test (MedTimeSlot.Api)'
2024-10-03 15:51:56.601 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5080/Register - - - 200 - application/json;+charset=utf-8 1464.8085ms
2024-10-03 15:52:22.820 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5080/Appointment application/json 86
2024-10-03 15:52:22.834 +07:00 [INF] CORS policy execution failed.
2024-10-03 15:52:22.836 +07:00 [INF] Request origin http://localhost:5080 does not have permission to access the resource.
2024-10-03 15:52:22.841 +07:00 [INF] Executing endpoint 'MedTimeSlot.Api.Controllers.AppointmentController.CreateAppointment (MedTimeSlot.Api)'
2024-10-03 15:52:22.856 +07:00 [INF] Route matched with {action = "CreateAppointment", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[MedTimeSlot.Api.DTOs.CellTime.CellTImeResponse] CreateAppointment(MedTimeSlot.Api.DTOs.Appointment.CreateAppointmentRequest) on controller MedTimeSlot.Api.Controllers.AppointmentController (MedTimeSlot.Api).
2024-10-03 15:52:23.005 +07:00 [INF] Executing action method MedTimeSlot.Api.Controllers.AppointmentController.CreateAppointment (MedTimeSlot.Api) - Validation state: "Valid"
2024-10-03 15:52:23.007 +07:00 [INF] Creating new appointment
2024-10-03 15:52:23.329 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Age", p."FirstName", p."LastName"
FROM "Patients" AS p
WHERE p."Id" = @__p_0
LIMIT 1
2024-10-03 15:52:23.354 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT d."Id", d."Age", d."FirstName", d."LastName", d."Speciality"
FROM "Doctors" AS d
WHERE d."Id" = @__p_0
LIMIT 1
2024-10-03 15:52:23.364 +07:00 [INF] Executed action MedTimeSlot.Api.Controllers.AppointmentController.CreateAppointment (MedTimeSlot.Api) in 506.1666ms
2024-10-03 15:52:23.365 +07:00 [INF] Executed endpoint 'MedTimeSlot.Api.Controllers.AppointmentController.CreateAppointment (MedTimeSlot.Api)'
2024-10-03 15:52:23.378 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5080/Appointment application/json 86 - 404 - application/json;+charset=utf-8 557.1968ms
2024-10-03 16:00:05.732 +07:00 [INF] Application is shutting down...
2024-10-03 18:46:34.593 +07:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
REVOKE CONNECT ON DATABASE "medTime" FROM PUBLIC;
SELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity WHERE datname = 'medTime';
2024-10-03 18:46:34.829 +07:00 [INF] Executed DbCommand (151ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP DATABASE "medTime";
